# 7-3-2: 親から子へのデータフロー（Props）

## 🎯 このセクションで学ぶこと

- Reactの基本原則である**単一方向のデータフロー**を理解する
- 親コンポーネントから子コンポーネントへデータを渡すための**Props**の使い方を習得する
- TypeScriptを使ってPropsに型を付け、コンポーネントのインターフェースを明確にする方法を学ぶ
- Propsが**読み取り専用**であることの重要性を理解する

## 導入

Reactアプリケーションは、小さなコンポーネントを組み合わせて大きなUIを構築していきます。しかし、コンポーネントが独立して存在するだけでは、意味のあるアプリケーションは作れません。コンポーネント同士が連携し、データを共有する必要があります。

Reactにおけるデータフローの最も基本的な原則は、**単一方向（トップダウン）**であることです。つまり、データは常に**親コンポーネントから子コンポーネントへ**と流れます。このデータの受け渡しに使われるのが**Props**（プロパティ）です。

Propsは、コンポーネントに渡すことができる引数のようなもので、親が持つ情報（Stateや固定値など）を子に伝えるための主要な手段です。この仕組みを理解することは、Reactを使いこなす上で不可欠です。

## 詳細解説

### 🔑 Propsとは？

Props（Propertiesの略）は、コンポーネントに渡される設定オブジェクトです。HTMLの属性に似た構文で、親コンポーネントから子コンポーネントにデータを渡します。

- **文字列**: `message="Hello World"`
- **数値や真偽値**: `age={28} isActive={true}`
- **変数やオブジェクト**: `user={currentUser}`
- **関数（イベントハンドラ）**: `onClick={handleClick}`

渡されたPropsは、子コンポーネントの関数の第一引数として、単一のオブジェクトとして受け取ることができます。

### Propsの渡し方と受け取り方（TypeScriptあり）

親から子へデータを渡すプロセスを、TypeScriptを使った具体的なコードで見ていきましょう。

#### 1. 子コンポーネントの定義

まず、データを受け取る子コンポーネント `UserProfile` を作成します。ここで重要なのは、**受け取るPropsの型を`interface`または`type`で定義する**ことです。これにより、どのようなデータが渡されるべきかが明確になり、型安全性が保証されます。

```tsx
// src/components/UserProfile.tsx
import React from 'react';

// ① 受け取るpropsの型を定義する
interface UserProfileProps {
  name: string;
  age: number;
  isAdmin: boolean;
}

// ② propsを引数として受け取り、型注釈を付ける
//    分割代入を使うとコードがスッキリする
const UserProfile: React.FC<UserProfileProps> = ({ name, age, isAdmin }) => {
  return (
    <div style={{ border: '1px solid #ccc', padding: '16px', margin: '16px' }}>
      <h3>User Profile</h3>
      <p><strong>Name:</strong> {name}</p>
      <p><strong>Age:</strong> {age}</p>
      <p><strong>Role:</strong> {isAdmin ? 'Administrator' : 'User'}</p>
    </div>
  );
};

export default UserProfile;
```

- `React.FC<UserProfileProps>`: このコンポーネントが `UserProfileProps` 型のpropsを受け取るReactの関数コンポーネントであることを示します。`children` プロパティを暗黙的に含むなどの特徴がありますが、単純に引数に型付け `(props: UserProfileProps)` する方法も一般的です。

#### 2. 親コンポーネントの定義

次に、`UserProfile` コンポーネントを呼び出し、データをPropsとして渡す親コンポーネント `App` を作成します。

```tsx
// src/App.tsx
import React, { useState } from 'react';
import UserProfile from './components/UserProfile';

function App() {
  const [user, setUser] = useState({
    name: 'Taro Yamada',
    age: 32,
    isAdmin: true,
  });

  return (
    <div>
      <h1>Welcome to My App</h1>
      {/* ③ 子コンポーネントにpropsを渡す */}
      <UserProfile 
        name={user.name} 
        age={user.age} 
        isAdmin={user.isAdmin} 
      />
      {/* オブジェクトをまとめて渡すことも可能 */}
      {/* <UserProfile {...user} /> */}
    </div>
  );
}

export default App;
```

- `UserProfile` を呼び出す際に、HTMLの属性のように `name={...}` `age={...}` と記述することで、データを渡しています。
- TypeScriptは `UserProfileProps` の型定義を見ているため、もし必須の `name` を渡し忘れたり、`age` に文字列を渡そうとしたりすると、コンパイルエラーで教えてくれます。

### ⚠️ Propsは読み取り専用 (Read-Only)

非常に重要なルールとして、**コンポーネントは自身のPropsを決して変更してはいけません。** Propsは親から一方的に流れてくるデータであり、子はそれを受け取って表示などに使うだけです。

```tsx
// やってはいけない悪い例
const UserProfile: React.FC<UserProfileProps> = ({ name, age, isAdmin }) => {
  // エラー: Cannot assign to 'name' because it is a read-only property.
  name = 'Jiro Suzuki'; // 絶対にやってはいけない！

  return ( /* ... */ );
}
```

なぜなら、もし子がPropsを自由に変更できてしまうと、データの流れが追跡困難になり、アプリケーションのどこで状態が変更されたのか分からなくなってしまうからです。これを「**純粋関数**」の原則と呼びます。同じPropsが与えられれば、常に同じUIを返す、ということです。

もし子が受け取ったデータを元に何かを変更したい場合は、次のセクションで学ぶ「子から親へのイベント通知」というパターンを使います。

## ✨ まとめ

- Reactのデータは、**親から子へ**という**単一方向**に流れる。
- 親から子へのデータ受け渡しには **Props** を使う。
- TypeScriptでは、子コンポーネントで受け取るPropsの型を `interface` や `type` で定義することで、型安全性を確保する。
- **Propsは読み取り専用**であり、子コンポーネント内で直接変更してはならない。
