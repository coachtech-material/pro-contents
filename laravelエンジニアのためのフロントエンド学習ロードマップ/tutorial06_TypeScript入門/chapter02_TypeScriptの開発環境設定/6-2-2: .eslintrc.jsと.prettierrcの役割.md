# 6-2-2: .eslintrc.jsと.prettierrcの役割

## 🎯 このセクションで学ぶこと

- **リンター（Linter）**と**フォーマッター（Formatter）**の役割の違いを明確に説明できるようになる
- **ESLint**の役割と、`.eslintrc.js`による設定方法を理解する
- **Prettier**の役割と、`.prettierrc`による設定方法を理解する
- これら2つのツールを連携させ、コードの品質と一貫性を自動的に維持する方法を習得する

## 導入

チームで開発を進める際、コードの書き方が人によってバラバラだと、レビューの効率が落ちたり、思わぬバグが生まれたりします。例えば、インデントがスペース2つの人もいれば4つの人もいる、`var`を使う人もいれば`const`しか使わない人もいる、といった状況です。

このようなコードの「**品質**」と「**スタイル**」の問題を自動的に解決してくれるのが、**ESLint（リンター）**と**Prettier（フォーマッター）**です。これらは現代のフロントエンド開発において、`tsconfig.json`と並んでほぼ必須とされるツールです。このセクションでは、それぞれの役割と設定方法を学び、クリーンで一貫性のあるコードを保つための環境を構築します。

## 詳細解説

### 🔑 リンター vs フォーマッター

まず、この2つのツールの根本的な違いを理解することが重要です。

| ツール | 役割 | 主な関心事 | 例 |
|:---|:---|:---|:---|
| **ESLint (リンター)** | **コードの品質をチェックする** | 「これはバグに繋がる可能性がある」<br>「この書き方は非推奨だ」 | - 使われていない変数を検出<br>- `var`の使用を禁止<br>- 無限ループの可能性を警告 |
| **Prettier (フォーマッター)** | **コードのスタイルを整形する** | 「このコードは読みにくい」<br>「インデントが揃っていない」 | - インデントをスペース2つに統一<br>- セミコロンを自動で付ける/消す<br>- 一行の長さを超えたら自動で改行 |

簡単に言えば、**ESLintは「コードの意味的な問題」**を、**Prettierは「コードの見た目の問題」**を扱います。これらは競合する部分もありますが、うまく設定することで強力な協力関係を築けます。

### ESLint: JavaScriptの静的解析ツール

ESLintは、コードを実行する前に潜在的な問題点やバグを検出するためのツールです。設定ファイルは `.eslintrc.js` (または `.json`, `.yml`) です。

#### `.eslintrc.js` の主要な設定

```javascript
module.exports = {
  // パーサー：どのバージョンのJavaScriptか、TypeScriptかなどをESLintに教える
  parser: "@typescript-eslint/parser",
  
  // 拡張：基本的なルールセットを読み込む
  extends: [
    "eslint:recommended", // ESLintが推奨する基本的なルール
    "plugin:@typescript-eslint/recommended", // TypeScript向けの推奨ルール
    "plugin:react/recommended", // React向けの推奨ルール
    "prettier" // Prettierと競合するルールを無効化（重要！）
  ],
  
  // プラグイン：特定のライブラリやフレームワーク向けのルールを追加する
  plugins: ["@typescript-eslint", "react"],
  
  // ルール：個別のルールを上書き・追加する
  rules: {
    "react/react-in-jsx-scope": "off", // React 17以降では不要なルールをオフに
    "no-unused-vars": "warn" // 未使用の変数はエラーではなく警告にする
  },
  
  // 環境：コードがどの環境で実行されるかを指定
  env: {
    browser: true, // ブラウザ環境
    node: true // Node.js環境
  }
};
```

- **`extends`**: 他の設定ファイルを継承します。`eslint:recommended` のような基本的なルールセットから、`prettier` のように他のツールとの連携設定まで、配列の末尾に書かれたものが優先されます。
- **`plugins`**: ESLint本体だけでは解釈できない構文（例: TypeScript, React）を扱えるようにしたり、特定のライブラリに関するルールを追加したりします。
- **`rules`**: `extends`で読み込んだルールを個別に上書きします。`"off"`, `"warn"`, `"error"` の3段階で設定できます。

### Prettier: コードフォーマッター

Prettierは、コードのスタイルに関するあらゆる議論を終わらせるための「独善的な」フォーマッターです。設定項目は意図的に少なくされており、細かい調整よりも「統一性」を重視します。設定ファイルは `.prettierrc` (または `.json`, `.js`) です。

#### `.prettierrc` の主要な設定

```json
{
  "semi": true, // 文末にセミコロンを付ける
  "singleQuote": true, // シングルクォートを使用する
  "tabWidth": 2, // インデントの幅をスペース2つ分にする
  "trailingComma": "es5" // 配列やオブジェクトの末尾のカンマを付ける (ES5互換)
}
```

これらの設定に従って、ファイルを保存したときなどに自動でコードが整形されます。

### ESLintとPrettierの連携

ESLintにもフォーマットに関するルールがあるため、Prettierと競合することがあります。例えば、「一行の最大文字数」を両方で設定していると、どちらを優先すべきか混乱します。

この問題を解決するのが `eslint-config-prettier` です。これをESLintの `extends` 配列の**一番最後**に追加することで、「**フォーマットに関するルールはすべてPrettierに任せる**」という意味になり、ESLintのフォーマット関連ルールが一括で無効化されます。

```javascript
// .eslintrc.js
{
  extends: [
    // ...他の設定
    "prettier" // 必ず最後に記述！
  ]
}
```

これにより、**ESLintはコード品質のチェックに専念**し、**Prettierはコードスタイルの整形に専念する**という、理想的な役割分担が実現できます。

## 💡 TIP

- VS Codeの拡張機能「**ESLint**」と「**Prettier - Code formatter**」をインストールし、`settings.json` で「ファイル保存時に自動でフォーマットする」設定を有効にすると、開発体験が劇的に向上します。手動でコマンドを実行する手間がなくなり、常に整形されたコードを保つことができます。

## ✨ まとめ

- **ESLint**はコードの**品質**をチェックする**リンター**であり、`.eslintrc.js`で設定する。
- **Prettier**はコードの**スタイル**を整形する**フォーマッター**であり、`.prettierrc`で設定する。
- これら2つは役割が異なる。ESLintに `eslint-config-prettier` を設定することで、フォーマットはPrettierに一任し、両者を効果的に連携させることができる。
- この環境を整えることで、チーム内でのコードの一貫性が保たれ、開発者は本質的なロジックの実装に集中できる。
