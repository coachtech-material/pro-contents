# 1-2-3: HTTPメソッドとステータスコード

## 🎯 このセクションで学ぶこと

*   HTTPリクエストで使われる主要な「HTTPメソッド」（GET, POST, PUT, DELETEなど）が、それぞれどのような「動詞」の役割を持つのかを理解します。
*   サーバーからのレスポンスに含まれる「HTTPステータスコード」（200, 404, 500など）が、処理結果を伝えるための「伝言メモ」であることを学びます。
*   Laravelのルーティング（`Route::get`, `Route::post`など）やコントローラーからのレスポンス（`response()->json()`, `abort()`）が、これらのHTTPの仕組みと直接対応していることを実感します。

### 🧠 先輩エンジニアの思考プロセス

Laravelエンジニアとして、あなたは既に無意識のうちにHTTPメソッドとステータスコードを扱ってきました。`Route::get`はGETメソッドを、`Route::post`はPOSTメソッドを処理するためのものです。このセクションの目的は、その「無意識の知識」を「意識的な、体系化された知識」に昇華させることです。なぜなら、フロントエンドとバックエンドが分離されたモダンな開発（API開発）では、このHTTPという共通言語を正確に使いこなすことが、両者の円滑なコミュニケーションに不可欠だからです。

**なぜこの順番で学ぶのか？**

1.  **「やりたいこと」を伝える言葉 (HTTPメソッド):** まず、クライアントがサーバーに「何をしてほしいのか」を伝えるための動詞であるHTTPメソッドを学びます。これにより、リクエストの「意図」が明確になります。
2.  **「結果」を伝える言葉 (ステータスコード):** 次に、サーバーがクライアントに「処理の結果どうだったか」を簡潔に伝えるための数字のコード、ステータスコードを学びます。これにより、レスポンスの「状態」がすぐにわかります。
3.  **Laravelとの関連付け:** 最後に、これらの概念がLaravelのどの機能と対応しているかを具体的に示すことで、既存の知識と新しい知識を結びつけ、理解を確実なものにします。

| このセクションでやること                                   |
| :--------------------------------------------------------- |
| 1. 主要なHTTPメソッドの役割と使い分けを理解する            |
| 2. 代表的なHTTPステータスコードの意味を覚える              |
| 3. HTTPの概念とLaravelの機能との対応関係を整理する         |

💡 **ポイント:** HTTPメソッドは「リクエストの動詞」、ステータスコードは「レスポンスの成績表」。この2つを正しく使うことが、綺麗なAPI設計の第一歩です。

### 導入: クライアントとサーバーの「共通言語」

前セクションまでで、クライアント（ブラウザ）がサーバーに「リクエスト」を送り、サーバーが「レスポンス」を返すという対話の流れを学びました。この対話で使われるのが、**HTTP（HyperText Transfer Protocol）**という共通言語（プロトコル）です。

HTTPは、ただ情報を送受信するだけでなく、そのリクエストが「何をしてほしいのか」、そしてレスポンスが「どういう結果だったのか」という、より豊かな情報を含んでいます。

*   **HTTPメソッド:** クライアントがサーバーに「してほしいこと」を伝えるための**動詞**です。「このページを**取得したい (GET)**」「このデータを**登録したい (POST)**」といった意図を伝えます。
*   **HTTPステータスコード:** サーバーがクライアントに「処理結果」を伝えるための3桁の**数字コード**です。「**成功したよ (200)**」「**探したけど見つからなかったよ (404)**」といった結果を簡潔に伝えます。

これらを正しく使い分けることで、クライアントとサーバーは、お互いの意図と結果を正確に、そして効率的に理解し合うことができるのです。

### 詳細解説: CRUDとHTTPメソッド

Webアプリケーションの基本的な機能は、データの**C**reate（作成）、**R**ead（読み取り）、**U**pdate（更新）、**D**elete（削除）の4つに集約されることが多く、これを**CRUD（クラッド）**と呼びます。HTTPメソッドは、このCRUD操作と非常によく対応しています。

| CRUD操作 | HTTPメソッド | 役割                                                                                                                                                             | Laravelのルート定義の例             |
| :------- | :----------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------- |
| **Create** | **POST**     | 新しいリソース（データ）を作成する。リクエストのボディ（本体）に作成したいデータを含めて送信する。                                                                 | `Route::post('/users', ...);`       |
| **Read**   | **GET**      | 既存のリソースを読み取る（取得する）。URLやクエリパラメータで取得したいリソースを指定する。                                                                        | `Route::get('/users/{id}', ...);`   |
| **Update** | **PUT / PATCH** | 既存のリソースを更新する。`PUT`はリソース全体を置き換える、`PATCH`はリソースの一部を修正するという意味合いの違いがある。リクエストのボディに更新内容を含める。 | `Route::put('/users/{id}', ...);`     |
| **Delete** | **DELETE**   | 既存のリソースを削除する。URLで削除したいリソースを指定する。                                                                                                    | `Route::delete('/users/{id}', ...);` |

💡 **GETとPOSTの重要な違い**

*   **GET:** サーバーから情報を取得するだけで、サーバーの状態を変更すべきではありません（**べき等性**）。リクエストの情報はURLに含まれるため、ブックマークや共有が可能です。しかし、パスワードのような機密情報を送るのには適していません。
*   **POST:** サーバーに新しいデータを作成するなど、サーバーの状態を変更します。リクエストの情報はURLには現れず、リクエストのボディに含まれるため、機密情報を安全に送信できます。

Laravelで`php artisan route:list`を実行した時に表示される`GET|HEAD`, `POST`, `PUT|PATCH`, `DELETE`が、まさにこれらのHTTPメソッドに対応しているのです。

### 詳細解説: レスポンス結果を伝えるステータスコード

HTTPステータスコードは、サーバーからのレスポンスがどのような状態であるかを示す3桁の数字です。最初の1桁で、レスポンスのカテゴリーが分かります。

| 1桁目 | カテゴリー         | 意味                                                               |
| :---- | :----------------- | :----------------------------------------------------------------- |
| **1xx** | **Informational**  | （あまり使われない）処理が継続していることを示す。                 |
| **2xx** | **Success**        | **成功。**リクエストが成功裏に受理され、処理されたことを示す。     |
| **3xx** | **Redirection**    | **リダイレクト。**リクエストを完了するために追加のアクションが必要。 |
| **4xx** | **Client Error**   | **クライアントエラー。**クライアント側のリクエストに問題がある。   |
| **5xx** | **Server Error**   | **サーバーエラー。**サーバー側でリクエストの処理中にエラーが発生。 |

以下は、実務で特によく遭遇する代表的なステータスコードです。

| コード | 意味                       | 具体的な状況例                                                                                                                                                                                                                                                                                       |
| :--- | :------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **200** | **OK**                     | リクエストは成功。GETリクエストでリソースが返された場合など、最も一般的な成功コード。                                                                                                                                                                                                                         |
| **201** | **Created**                | リソースの作成に成功。POSTリクエストで新しいユーザーが作成された場合など。                                                                                                                                                                                                                           |
| **301** | **Moved Permanently**      | リソースのURLが恒久的に変更された。SEO（検索エンジン最適化）で重要。                                                                                                                                                                                                                                   |
| **302** | **Found**                  | リソースのURLが一時的に変更された。Laravelの`redirect()`ヘルパーのデフォルト。                                                                                                                                                                                                                         |
| **400** | **Bad Request**            | リクエストの構文がおかしい。送信されたJSONの形式が不正な場合など。                                                                                                                                                                                                                                   |
| **401** | **Unauthorized**           | **認証エラー。**ログインしていないなど、リクエストを行う権限がない。                                                                                                                                                                                                                                   |
| **403** | **Forbidden**              | **認可エラー。**ログインはしているが、そのリソースにアクセスする権限がない（例: 他人の投稿を編集しようとした）。                                                                                                                                                                                 |
| **404** | **Not Found**              | リクエストされたリソースが見つからない。存在しないURLにアクセスした場合。                                                                                                                                                                                                                           |
| **500** | **Internal Server Error**  | サーバー内部で予期せぬエラーが発生。Laravelアプリケーションでコードのバグなどがあった場合。                                                                                                                                                                                                              |
| **503** | **Service Unavailable**    | サービスが利用不可。サーバーがメンテナンス中や過負荷の場合。                                                                                                                                                                                                                                       |

フロントエンド開発では、このステータスコードに応じて処理を分岐させることが非常に重要です。例えば、`200`なら成功画面を表示し、`401`ならログインページにリダイレクトし、`500`なら「サーバーでエラーが発生しました」というメッセージを表示する、といった具合です。

### ✨ まとめ

*   **HTTPメソッドはリクエストの動詞:** `GET`（取得）、`POST`（作成）、`PUT/PATCH`（更新）、`DELETE`（削除）といったメソッドで、リクエストの意図を明確に伝えます。
*   **CRUD操作との対応:** これらのメソッドは、アプリケーションの基本機能であるCRUDと密接に関連しています。
*   **ステータスコードはレスポンスの成績表:** `2xx`（成功）、`3xx`（リダイレクト）、`4xx`（クライアントエラー）、`5xx`（サーバーエラー）といったコードで、処理結果を簡潔に伝えます。
*   **フロントエンドの役割:** フロントエンドは、レスポンスのステータスコードを解釈し、その結果に応じて画面表示やユーザーへの通知を適切に行う責任があります。

### 📝 学習のポイント

このセクションを終えた今、あなたは以下のことができるようになっているはずです。

*   [ ] GETとPOSTメソッドの主な違いと、それぞれの使い分けの場面を説明できる。
*   [ ] ユーザー登録フォームを送信する際にはPOSTメソッドが、記事を閲覧する際にはGETメソッドが適切である理由を説明できる。
*   [ ] ステータスコード「404」と「500」の違いを、クライアントとサーバーのどちらに原因があるかという観点から説明できる。
