# 5-3-2: Networkタブでのデバッグ方法

## 🎯 このセクションで学ぶこと

- ブラウザの開発者ツール（DevTools）の「Network」タブの基本的な使い方を習得する
- `fetch` で行われたAPIリクエストの詳細（ヘッダー、ペイロード、レスポンス）を確認できるようになる
- API通信に関する問題（404エラー、CORSエラーなど）の基本的な原因を特定できるようになる

## 導入

フロントエンド開発において、サーバーとのAPI通信はほぼ必ず発生します。「APIから期待したデータが返ってこない」「画像が表示されない」「ボタンを押しても何も起こらない」といった問題の多くは、このAPI通信部分に原因が潜んでいます。

ブラウザに搭載されている開発者ツールの「Network」タブは、ブラウザとサーバーの間で行われるすべての通信を監視し、デバッグするための強力な武器です。Laravel開発でTelescopeやログファイルを使ってAPIリクエストをデバッグするのと同様に、フロントエンドではこのNetworkタブを使いこなすことが必須スキルとなります。

## 詳細解説

### Networkタブを開く

- **Windows/Linux**: `Ctrl + Shift + I` または `F12` キー
- **Mac**: `Cmd + Opt + I`

開発者ツールが開いたら、上部のタブから「Network」を選択します。

### Networkタブの基本的な見方

Networkタブを開いた状態でページをリロードするか、APIリクエストをトリガーする操作（例: ボタンクリック）を行うと、発生した通信が一覧で表示されます。

![Network Tab Overview](https://raw.githubusercontent.com/coachtech-material/pro-contents/main/images/tutorial05/network-tab.png)
*(この画像はダミーです。実際の表示とは異なる場合があります)*

一覧の各行が、一つのHTTPリクエストを表しています。`fetch` を使ってAPIを呼び出すと、ここに行が追加されます。

### リクエストの詳細を確認する

一覧から確認したいリクエスト（例: `users` や `posts`）をクリックすると、そのリクエストに関するさらに詳細な情報が表示されます。

特に重要なのは以下のタブです。

1.  **Headers**: リクエストとレスポンスのヘッダー情報が表示されます。
    - **General**: リクエストURL、メソッド（GET, POSTなど）、ステータスコード（`200 OK`, `404 Not Found`など）といった基本情報。
    - **Response Headers**: サーバーからのレスポンスに含まれるヘッダー。`Content-Type` など。
    - **Request Headers**: ブラウザからサーバーへ送信したヘッダー。`Authorization`（認証トークン）などが含まれます。

2.  **Payload**: (POSTやPUTリクエストの場合) サーバーに送信したデータ（リクエストボディ）が表示されます。JSON形式のデータなどを確認できます。

3.  **Preview**: サーバーからのレスポンスボディを、ブラウザが整形して見やすく表示してくれます。JSONデータであれば、ツリー形式で展開して確認できます。

4.  **Response**: サーバーからのレスポンスボディの生データが表示されます。

### デバッグのシナリオ例

#### シナリオ1: データが正しく表示されない

- **確認すること**: `Preview` タブまたは `Response` タブ
- **原因の推測**: 
    - そもそも期待したデータ構造（キーの名前など）で返ってきているか？
    - レスポンスが空の配列 `[]` や `null` になっていないか？
    - エラーメッセージがJSONやHTML形式で返ってきていないか？

#### シナリオ2: 404 Not Found エラーが発生する

- **確認すること**: `Headers` タブの `General` セクションにある `Request URL`
- **原因の推測**: 
    - `fetch` に指定したURLのタイポはないか？
    - APIのエンドポイントのパスが正しいか？

#### シナリオ3: 認証エラー（401 Unauthorized / 403 Forbidden）が発生する

- **確認すること**: `Headers` タブの `Request Headers`
- **原因の推測**: 
    - `Authorization` ヘッダーに正しくアクセストークンがセットされているか？
    - トークンの形式（例: `Bearer ...`）は正しいか？

## 💡 TIP

- Networkタブの上部にある `Fetch/XHR` フィルタをクリックすると、`fetch` や `XMLHttpRequest` によるAPI通信のみに絞り込んで表示できるため、非常に便利です。
- `Preserve log` にチェックを入れておくと、ページをリロードしても通信ログが消えずに残ります。

## ✨ まとめ

- Networkタブは、フロントエンドとサーバー間の通信をデバッグするための必須ツール。
- リクエスト一覧から個別の通信を選択し、`Headers`, `Preview`, `Response` タブを確認することで、通信の問題を詳細に調査できる。
- `Fetch/XHR` フィルタを使うと、API通信のデバッグが効率的になる。
