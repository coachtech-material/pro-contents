<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 2 ãƒãƒ³ã‚ºã‚ªãƒ³: useFetchãƒ•ãƒƒã‚¯ã‚’ä½œæˆã™ã‚‹ | Laravelã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ãŸã‚ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å­¦ç¿’ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—</title>
    <meta name="description" content="PHP/Laravelã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚’ç¿’å¾—ã™ã‚‹ãŸã‚ã®æ•™æ">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="outer">
        <header>
            <h1><a href="index.html">Laravelã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ãŸã‚ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å­¦ç¿’ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—</a></h1>
            <p class="description">PHP/Laravelã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚’ç¿’å¾—ã™ã‚‹ãŸã‚ã®æ•™æ</p>
        </header>
        <div id="container">
            <aside>
                <div id="side-inner">
                    <div class="side-title">ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ä¸€è¦§</div>
<div class="side"><ul>
<li><a href="tutorial01_é–‹ç™ºç’°å¢ƒã¨Webã®åŸºç¤å›ºã‚.html">Tutorial 1: é–‹ç™ºç’°å¢ƒã¨Webã®åŸºç¤å›ºã‚</a></li>
<li><a href="tutorial02_HTML_CSSåŸºç¤.html">Tutorial 2: HTML/CSSåŸºç¤</a></li>
<li><a href="tutorial03_Tailwind_CSSå¾¹åº•ç¿’å¾—.html">Tutorial 3: Tailwind CSSå¾¹åº•ç¿’å¾—</a></li>
<li><a href="tutorial04_JavaScript_åŸºç¤ã¨DOMæ“ä½œ.html">Tutorial 4: JavaScriptåŸºç¤ã¨DOMæ“ä½œ</a></li>
<li><a href="tutorial05_JavaScript_å¿œç”¨ã¨éåŒæœŸå‡¦ç†.html">Tutorial 5: JavaScriptå¿œç”¨ã¨éåŒæœŸå‡¦ç†</a></li>
<li><a href="tutorial06_TypeScriptå…¥é–€.html">Tutorial 6: TypeScriptå…¥é–€</a></li>
<li><a href="tutorial07_Reactå…¥é–€.html">Tutorial 7: Reactå…¥é–€</a></li>
<li><a href="tutorial08_Reactå¿œç”¨.html" class="current">Tutorial 8: Reactå¿œç”¨</a></li>
<li><a href="tutorial09_Next.js.html">Tutorial 9: Next.js</a></li>
<li><a href="tutorial10_Laravel_x_Next.js.html">Tutorial 10: Laravel Ã— Next.js</a></li>
<li><a href="tutorial11_ãƒ†ã‚¹ãƒˆ.html">Tutorial 11: ãƒ†ã‚¹ãƒˆ</a></li>
<li><a href="tutorial12_column.html">ä¸Šç´šã‚³ãƒ©ãƒ : Webãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®æ·±å±¤ç†è§£</a></li>
</ul></div>

                </div>
            </aside>
            <div id="content">
                <div class="inner">
                    <div class="breadcrumb"><a href="index.html">ãƒ›ãƒ¼ãƒ </a><span>></span><a href="tutorial08_Reactå¿œç”¨.html">Tutorial 8: Reactå¿œç”¨</a><span>></span><a href="tutorial08_Reactå¿œç”¨_chapter02_ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯.html">Chapter 2: ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯</a><span>></span>Chapter 2 ãƒãƒ³ã‚ºã‚ªãƒ³: useFetchãƒ•ãƒƒã‚¯ã‚’ä½œæˆã™ã‚‹</div>
                    <div class="section-content">
<h1 id="8-2-4-chapter-2-usefetch">8-2-4: Chapter 2 ãƒãƒ³ã‚ºã‚ªãƒ³: useFetchãƒ•ãƒƒã‚¯ã‚’ä½œæˆã™ã‚‹</h1>
<h2 id="_1">ğŸ¯ ã“ã®ãƒãƒ³ã‚ºã‚ªãƒ³ã®ç›®çš„</h2>
<p>ã“ã®ãƒãƒ³ã‚ºã‚ªãƒ³ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿å–å¾—ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–ã—ãŸ<code>useFetch</code>ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½œæˆã—ã¾ã™ã€‚ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã‚’ä¸€ã¤ã®ãƒ•ãƒƒã‚¯ã«ã¾ã¨ã‚ã‚‹ã“ã¨ã§ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«ä¿ã¤æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚</p>
<h2 id="_2">æº–å‚™</h2>
<p>Chapter 1ã§ä½œæˆã—ãŸReactãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã‹ã€æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>
<pre class="codehilite"><code class="language-bash"># æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹å ´åˆ
npx create-react-app custom-hooks-practice --template typescript
cd custom-hooks-practice
npm start
</code></pre>

<h2 id="step-1-usefetch">Step 1: åŸºæœ¬çš„ãªuseFetchãƒ•ãƒƒã‚¯ã®ä½œæˆ</h2>
<p>ã¾ãšã€ã‚·ãƒ³ãƒ—ãƒ«ãª<code>useFetch</code>ãƒ•ãƒƒã‚¯ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
<p><code>src/hooks/useFetch.ts</code>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
<pre class="codehilite"><code class="language-typescript">import { useState, useEffect } from 'react';

// ãƒ•ãƒƒã‚¯ã®æˆ»ã‚Šå€¤ã®å‹å®šç¾©
interface UseFetchResult&lt;T&gt; {
  data: T | null;
  loading: boolean;
  error: Error | null;
}

export function useFetch&lt;T&gt;(url: string): UseFetchResult&lt;T&gt; {
  const [data, setData] = useState&lt;T | null&gt;(null);
  const [loading, setLoading] = useState&lt;boolean&gt;(true);
  const [error, setError] = useState&lt;Error | null&gt;(null);

  useEffect(() =&gt; {
    const fetchData = async () =&gt; {
      setLoading(true);
      setError(null);

      try {
        const response = await fetch(url);
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        const json = await response.json() as T;
        setData(json);
      } catch (e) {
        setError(e instanceof Error ? e : new Error('Unknown error'));
      } finally {
        setLoading(false);
      }
    };

    fetchData();
  }, [url]);

  return { data, loading, error };
}
</code></pre>

<h2 id="step-2-usefetch">Step 2: useFetchãƒ•ãƒƒã‚¯ã‚’ä½¿ã£ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä½œæˆ</h2>
<p>ä½œæˆã—ãŸãƒ•ãƒƒã‚¯ã‚’ä½¿ã£ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã‚’è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚</p>
<p><code>src/components/UserList.tsx</code>ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
<pre class="codehilite"><code class="language-typescript">import { useFetch } from '../hooks/useFetch';

// APIã‹ã‚‰å–å¾—ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å‹
interface User {
  id: number;
  name: string;
  email: string;
  company: {
    name: string;
  };
}

export function UserList() {
  const { data, loading, error } = useFetch&lt;User[]&gt;(
    'https://jsonplaceholder.typicode.com/users'
  );

  if (loading) {
    return &lt;div className=&quot;loading&quot;&gt;èª­ã¿è¾¼ã¿ä¸­...&lt;/div&gt;;
  }

  if (error) {
    return &lt;div className=&quot;error&quot;&gt;ã‚¨ãƒ©ãƒ¼: {error.message}&lt;/div&gt;;
  }

  if (!data || data.length === 0) {
    return &lt;div className=&quot;empty&quot;&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“&lt;/div&gt;;
  }

  return (
    &lt;div className=&quot;user-list&quot;&gt;
      &lt;h2&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§&lt;/h2&gt;
      &lt;ul&gt;
        {data.map((user) =&gt; (
          &lt;li key={user.id}&gt;
            &lt;strong&gt;{user.name}&lt;/strong&gt;
            &lt;p&gt;Email: {user.email}&lt;/p&gt;
            &lt;p&gt;Company: {user.company.name}&lt;/p&gt;
          &lt;/li&gt;
        ))}
      &lt;/ul&gt;
    &lt;/div&gt;
  );
}
</code></pre>

<h2 id="step-3">Step 3: å†å–å¾—æ©Ÿèƒ½ã®è¿½åŠ </h2>
<p>ãƒ‡ãƒ¼ã‚¿ã‚’æ‰‹å‹•ã§å†å–å¾—ã§ãã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã™ã€‚</p>
<p><code>src/hooks/useFetch.ts</code>ã‚’æ›´æ–°ã—ã¾ã™ã€‚</p>
<pre class="codehilite"><code class="language-typescript">import { useState, useEffect, useCallback } from 'react';

interface UseFetchResult&lt;T&gt; {
  data: T | null;
  loading: boolean;
  error: Error | null;
  refetch: () =&gt; void; // å†å–å¾—é–¢æ•°ã‚’è¿½åŠ 
}

export function useFetch&lt;T&gt;(url: string): UseFetchResult&lt;T&gt; {
  const [data, setData] = useState&lt;T | null&gt;(null);
  const [loading, setLoading] = useState&lt;boolean&gt;(true);
  const [error, setError] = useState&lt;Error | null&gt;(null);

  const fetchData = useCallback(async () =&gt; {
    setLoading(true);
    setError(null);

    try {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      const json = await response.json() as T;
      setData(json);
    } catch (e) {
      setError(e instanceof Error ? e : new Error('Unknown error'));
    } finally {
      setLoading(false);
    }
  }, [url]);

  useEffect(() =&gt; {
    fetchData();
  }, [fetchData]);

  const refetch = useCallback(() =&gt; {
    fetchData();
  }, [fetchData]);

  return { data, loading, error, refetch };
}
</code></pre>

<h2 id="step-4">Step 4: å†å–å¾—ãƒœã‚¿ãƒ³ã®è¿½åŠ </h2>
<p><code>src/components/UserList.tsx</code>ã«å†å–å¾—ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ã€‚</p>
<pre class="codehilite"><code class="language-typescript">import { useFetch } from '../hooks/useFetch';

interface User {
  id: number;
  name: string;
  email: string;
  company: {
    name: string;
  };
}

export function UserList() {
  const { data, loading, error, refetch } = useFetch&lt;User[]&gt;(
    'https://jsonplaceholder.typicode.com/users'
  );

  return (
    &lt;div className=&quot;user-list&quot;&gt;
      &lt;div className=&quot;header&quot;&gt;
        &lt;h2&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§&lt;/h2&gt;
        &lt;button onClick={refetch} disabled={loading}&gt;
          {loading ? 'èª­ã¿è¾¼ã¿ä¸­...' : 'å†å–å¾—'}
        &lt;/button&gt;
      &lt;/div&gt;

      {loading &amp;&amp; &lt;div className=&quot;loading&quot;&gt;èª­ã¿è¾¼ã¿ä¸­...&lt;/div&gt;}

      {error &amp;&amp; &lt;div className=&quot;error&quot;&gt;ã‚¨ãƒ©ãƒ¼: {error.message}&lt;/div&gt;}

      {!loading &amp;&amp; !error &amp;&amp; data &amp;&amp; (
        &lt;ul&gt;
          {data.map((user) =&gt; (
            &lt;li key={user.id}&gt;
              &lt;strong&gt;{user.name}&lt;/strong&gt;
              &lt;p&gt;Email: {user.email}&lt;/p&gt;
              &lt;p&gt;Company: {user.company.name}&lt;/p&gt;
            &lt;/li&gt;
          ))}
        &lt;/ul&gt;
      )}
    &lt;/div&gt;
  );
}
</code></pre>

<h2 id="step-5-apptsx">Step 5: App.tsxã®æ›´æ–°</h2>
<p><code>src/App.tsx</code>ã‚’æ›´æ–°ã—ã¦ã€UserListã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</p>
<pre class="codehilite"><code class="language-typescript">import { UserList } from './components/UserList';
import './App.css';

function App() {
  return (
    &lt;div className=&quot;App&quot;&gt;
      &lt;h1&gt;ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ç·´ç¿’&lt;/h1&gt;
      &lt;UserList /&gt;
    &lt;/div&gt;
  );
}

export default App;
</code></pre>

<h2 id="step-6">Step 6: ã‚¹ã‚¿ã‚¤ãƒ«ã®è¿½åŠ </h2>
<p><code>src/App.css</code>ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ã€‚</p>
<pre class="codehilite"><code class="language-css">.App {
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
}

.user-list .header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.user-list ul {
  list-style: none;
  padding: 0;
}

.user-list li {
  border: 1px solid #ddd;
  padding: 15px;
  margin-bottom: 10px;
  border-radius: 8px;
}

.user-list li strong {
  font-size: 1.2em;
}

.user-list li p {
  margin: 5px 0;
  color: #666;
}

.loading {
  text-align: center;
  padding: 20px;
  color: #666;
}

.error {
  color: red;
  padding: 20px;
  background-color: #fee;
  border-radius: 8px;
}

button {
  padding: 10px 20px;
  background-color: #007bff;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

button:disabled {
  background-color: #ccc;
  cursor: not-allowed;
}

button:hover:not(:disabled) {
  background-color: #0056b3;
}
</code></pre>

<h2 id="_3">âœ¨ ã¾ã¨ã‚</h2>
<p>ã“ã®ãƒãƒ³ã‚ºã‚ªãƒ³ã§ã¯ã€ä»¥ä¸‹ã®ã“ã¨ã‚’å®Ÿè·µã—ã¾ã—ãŸã€‚</p>
<ul>
<li>ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã‚’ä½¿ã£ãŸå‹å®‰å…¨ãª<code>useFetch</code>ãƒ•ãƒƒã‚¯ã®ä½œæˆ</li>
<li>ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€ã‚¨ãƒ©ãƒ¼ã€ãƒ‡ãƒ¼ã‚¿ã®3ã¤ã®çŠ¶æ…‹ç®¡ç†</li>
<li><code>useCallback</code>ã‚’ä½¿ã£ãŸå†å–å¾—æ©Ÿèƒ½ã®å®Ÿè£…</li>
<li>ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½¿ã£ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç°¡æ½”ãªå®Ÿè£…</li>
</ul>
<p><code>useFetch</code>ãƒ•ãƒƒã‚¯ã‚’ä½¿ã†ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿å–å¾—ã®ãƒ­ã‚¸ãƒƒã‚¯ãŒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰åˆ†é›¢ã•ã‚Œã€ã‚³ãƒ¼ãƒ‰ã®å†åˆ©ç”¨æ€§ã¨å¯èª­æ€§ãŒå‘ä¸Šã—ã¾ã—ãŸã€‚å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€TanStack Queryã®ã‚ˆã†ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†ã“ã¨ãŒå¤šã„ã§ã™ãŒã€ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®åŸºæœ¬çš„ãªè€ƒãˆæ–¹ã‚’ç†è§£ã™ã‚‹ã“ã¨ã¯éå¸¸ã«é‡è¦ã§ã™ã€‚</p>
<p>æ¬¡ã®ãƒãƒ£ãƒ—ã‚¿ãƒ¼ã§ã¯ã€React Hook Formã‚„Zodãªã©ã€å®Ÿå‹™ã§ã‚ˆãä½¿ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã¤ã„ã¦å­¦ã‚“ã§ã„ãã¾ã—ã‚‡ã†ã€‚</p>
</div>
<div class="section-nav">
<a href="tutorial08_Reactå¿œç”¨_chapter02_ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯_8-2-3: å®Ÿå‹™ã§ã‚ˆãä½¿ã†ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®ä¾‹.html" class="prev">å®Ÿå‹™ã§ã‚ˆãä½¿ã†ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®ä¾‹</a>
<span></span>
</div>

                </div>
            </div>
        </div>
        <footer>
            &copy; 2025 Laravelã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ãŸã‚ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å­¦ç¿’ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—
        </footer>
    </div>
</body>
</html>
